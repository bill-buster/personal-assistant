---
description: Documentation requirements and patterns to ensure all features are documented
globs: ["**/*.ts", "**/*.md", "docs/**/*.md", "README.md", "CONTRIBUTING.md"]
alwaysApply: false
---

# Documentation Requirements

This rule ensures all code changes include appropriate documentation updates.

## Documentation Checklist

When adding or modifying code, ensure documentation is updated:

### New CLI Commands or Flags

- [ ] Add to `docs/COMMANDS.md` under appropriate section
- [ ] Add to `README.md` if it's a commonly used command
- [ ] Add to `docs/QUICKSTART.md` if it's essential for getting started
- [ ] Update CLI help text in `src/app/cli.ts` USAGE constant

### New Configuration Options

- [ ] Add to `docs/CONFIGURATION.md` with:
  - Type and description
  - Default value
  - Example usage
- [ ] Add to `README.md` Configuration section if commonly used
- [ ] Update config schema comments in `src/core/config.ts`

### New Environment Variables

- [ ] Add to `docs/CONFIGURATION.md` Environment Variables table
- [ ] Add to `README.md` Environment Variables table
- [ ] Document in code comments where the variable is used

### New Tools

- [ ] Add to `docs/COMMANDS.md` "Tools Available via REPL/Router" section
- [ ] Add tool description to `src/tools/schemas.ts` ToolSpec
- [ ] Document in `README.md` "Available Tools" section if significant

### New REPL Commands

- [ ] Add to `docs/COMMANDS.md` REPL Commands table
- [ ] Add to `docs/QUICKSTART.md` REPL section
- [ ] Update help text in `src/app/repl.ts` handleCommand function

### New Features or Improvements

- [ ] Add to `docs/10X_IMPROVEMENTS.md` if it's a significant improvement
- [ ] Update `README.md` Features section if user-facing
- [ ] Add to `CHANGELOG.md` or release notes if applicable

### API Changes

- [ ] Update JSDoc comments
- [ ] Update type definitions with descriptions
- [ ] Consider adding to API documentation if public API

## Documentation Patterns

### Command Documentation Format

```markdown
| Command | Description |
|---------|-------------|
| `command <arg>` | Brief description |
```

### Configuration Documentation Format

```markdown
#### `optionName`
- **Type**: `string` | `number` | `boolean` | `object`
- **Description**: What it does
- **Default**: `defaultValue`
- **Example**: 
  ```json
  {
    "optionName": "value"
  }
  ```
```

### Environment Variable Format

```markdown
| Variable | Description | Default |
|----------|-------------|---------|
| `VAR_NAME` | What it does | `default` |
```

## Where to Document

### User-Facing Features

1. **README.md** - Quick start, common commands, overview
2. **docs/QUICKSTART.md** - Getting started guide
3. **docs/COMMANDS.md** - Complete command reference
4. **docs/CONFIGURATION.md** - All configuration options

### Developer-Facing Features

1. **CONTRIBUTING.md** - Development workflow
2. **docs/WORKFLOW.md** - Detailed development guide
3. **docs/10X_IMPROVEMENTS.md** - Significant improvements
4. **Code comments** - Inline documentation

### Internal/Implementation Details

1. **JSDoc comments** - Function/class documentation
2. **Type definitions** - Type-level documentation
3. **Code comments** - Complex logic explanations

## Documentation Standards

### Always Include

- **What**: Clear description of what the feature does
- **Why**: Brief explanation of why it exists (if not obvious)
- **How**: Usage examples or code snippets
- **When**: When to use it (if applicable)

### Code Examples

Always include working examples:

```bash
# Good: Shows actual usage
assistant remember "Meeting at 3pm"
```

```bash
# Bad: Too abstract
assistant <command> <args>
```

### Cross-References

- Link to related documentation
- Reference other relevant sections
- Point to examples or tutorials

## Before Committing

Checklist before committing code changes:

- [ ] All new commands documented in `docs/COMMANDS.md`
- [ ] All new config options documented in `docs/CONFIGURATION.md`
- [ ] All new env vars documented in both `README.md` and `docs/CONFIGURATION.md`
- [ ] README.md updated if feature is user-facing
- [ ] JSDoc comments added for new exported functions
- [ ] Type definitions include descriptions
- [ ] Examples included where helpful

## Anti-Patterns

### ❌ Don't Do This

- Add features without updating docs
- Document only in code comments (user docs needed too)
- Leave TODO comments about documentation
- Assume users will find it in the code

### ✅ Do This Instead

- Update docs alongside code changes
- Put user-facing docs in markdown files
- Complete documentation before marking PR ready
- Make docs discoverable (in expected locations)

## Examples

### Adding a New CLI Command

```typescript
// In src/app/cli.ts
case 'newcommand':
    result = handleNewCommand(args);
    break;
```

**Required Documentation Updates:**

1. `docs/COMMANDS.md`:
   ```markdown
   ### New Category
   | Command | Description |
   |---------|-------------|
   | `assistant newcommand <args>` | Does something useful |
   ```

2. `src/app/cli.ts` USAGE constant:
   ```typescript
   newcommand <args>    Do something useful
   ```

3. `README.md` (if commonly used):
   ```markdown
   assistant newcommand <args>
   ```

### Adding a New Config Option

```typescript
// In src/core/config.ts
newOption: z.string().optional(),
```

**Required Documentation Updates:**

1. `docs/CONFIGURATION.md`:
   ```markdown
   #### `newOption`
   - **Type**: `string`
   - **Description**: What it does
   - **Default**: Not set
   ```

2. `README.md` Configuration Options table:
   ```markdown
   | `newOption` | string | Description | - |
   ```

### Adding a New Environment Variable

```typescript
// In src/core/config.ts
if (process.env.NEW_VAR) {
    config.newOption = process.env.NEW_VAR;
}
```

**Required Documentation Updates:**

1. `docs/CONFIGURATION.md` Environment Variables table
2. `README.md` Environment Variables table
3. Code comment explaining usage

## Reminders

When working on code, ask yourself:

1. **Is this user-facing?** → Update user docs (README, COMMANDS, QUICKSTART)
2. **Is this configurable?** → Update CONFIGURATION.md
3. **Is this a new feature?** → Consider adding to 10X_IMPROVEMENTS.md
4. **Is this an API change?** → Update JSDoc and type definitions
5. **Will users need examples?** → Include working examples

## Integration with Other Rules

- **Testing Rule**: Document test commands and test configuration
- **Tools Rule**: Document new tools in COMMANDS.md
- **Security Rule**: Document security-related config options
- **Providers Rule**: Document provider-specific configuration
