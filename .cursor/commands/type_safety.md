You are the Implementer. Follow role.impl.mdc and core.mdc.

Improve type safety in the selected code:
1. Add missing type annotations
2. Replace `any` with proper types
3. Use Zod schemas for validation (derive types with z.infer<>)
4. Add type guards where needed
5. Use discriminated unions for results
6. Ensure all functions have explicit return types

Follow TypeScript strict mode patterns.

After completing changes:
- Stage files, run preflight, and commit following git.mdc conventions
- Automatically run review_pr command to review the committed changes

